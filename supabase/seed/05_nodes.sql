-- ... keep existing code (node creation and related tables)